Upgrade to PyCharm Professional
Enhance the capabilities of your Jupyter notebooks by seamlessly integrating them with the full array of features available in PyCharm Professional.

PyCharm-grade coding assistance for Jupyter

Advanced debugging and real-time variable monitoring in your notebooks with our built-in debugger

Interactive tables that enable you to browse, sort, view, and export your data

Enhanced integrations, including version control support, problem analysis, a file viewer pane, and much more

Get PyCharm Professional Free 1-month trial

Импорт библиотек
!pip install medpy
Collecting medpy
  Downloading MedPy-0.5.1.tar.gz (156 kB)
?25l     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 0.0/156.2 kB ? eta -:--:--
2K     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸━━━━━━━━━━━ 112.6/156.2 kB 3.2 MB/s eta 0:00:01
2K     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 156.2/156.2 kB 3.1 MB/s eta 0:00:00
?25h  Preparing metadata (setup.py) ... ?25l?25hdone
Requirement already satisfied: scipy>=1.10 in /usr/local/lib/python3.10/dist-packages (from medpy) (1.11.4)
Requirement already satisfied: numpy>=1.24 in /usr/local/lib/python3.10/dist-packages (from medpy) (1.25.2)
Collecting SimpleITK>=2.1 (from medpy)
  Downloading SimpleITK-2.3.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (52.7 MB)
2K     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 52.7/52.7 MB 24.3 MB/s eta 0:00:00
?25hBuilding wheels for collected packages: medpy
  Building wheel for medpy (setup.py) ... ?25l?25hdone
  Created wheel for medpy: filename=MedPy-0.5.1-cp310-cp310-linux_x86_64.whl size=762859 sha256=d44e666006a2251f414eee13455c787d3501d4b80d37b08be3ebcebf67d32563
  Stored in directory: /root/.cache/pip/wheels/e6/8f/f9/7fec657d34ad3ebd2ea3ca5ad0e526f8fea93c3fb4a26c3416
Successfully built medpy
Installing collected packages: SimpleITK, medpy
Successfully installed SimpleITK-2.3.1 medpy-0.5.1

from google.colab import auth, drive
from googleapiclient.discovery import build

auth.authenticate_user()
drive.mount('/content/drive')
Mounted at /content/drive

from PIL import Image
import os
import pandas as pd
import numpy as np
from matplotlib import pyplot as plt, cm

from medpy.metric import dc, jc
from medpy.io import load, header

from sklearn.model_selection import train_test_split as tts

from tqdm import tqdm_notebook, trange

SEED = 42
Подготовка данных
def path(fname, num):
    return f'drive/My Drive/CHAOS/Train_Sets/CT/' + fname

def get_data(num):
    X_path = path('', num)
    X_filenames = []
    y_filenames = []
    for directory in tqdm_notebook(os.listdir(X_path)[:-1], position=0):
        for dirName, subdirList, fileList in os.walk(X_path+directory):
            for filename in fileList:
                if ".dcm" in filename.lower():
                    X_filenames.append(os.path.join(dirName, filename))
                if ".png" in filename.lower():
                    y_filenames.append(os.path.join(dirName, filename))
    assert len(X_filenames) == len(y_filenames)
    return sorted(X_filenames), sorted(y_filenames)
X_filenames1, y_filenames1 = get_data(1)

X_filenames = X_filenames1
y_filenames = y_filenames1

len(X_filenames), len(y_filenames)
print(X_filenames)
print(y_filenames)
<ipython-input-4-9679fda2b1a7>:8: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0
Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`
  for directory in tqdm_notebook(os.listdir(X_path)[:-1], position=0):

['drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0000,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0001,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0002,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0003,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0004,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0005,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0006,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0007,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0008,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0009,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0010,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0011,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0012,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0013,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0014,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0015,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0016,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0017,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0018,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0019,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0020,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0021,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0022,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0023,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0024,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0025,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0026,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0027,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0028,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0029,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0030,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0031,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0032,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0033,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0034,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0035,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0036,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0037,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0038,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0039,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0040,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0041,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0042,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0043,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0044,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0045,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0046,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0047,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0048,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0049,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0050,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0051,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0052,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0053,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0054,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0055,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0056,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0057,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0058,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0059,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0060,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0061,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0062,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0063,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0064,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0065,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0066,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0067,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0068,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0069,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0070,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0071,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0072,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0073,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0074,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0075,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0076,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0077,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0078,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0079,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0080,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0081,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0082,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0083,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0084,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0085,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0086,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0087,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0088,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0089,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0090,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0091,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0092,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0093,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0094,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT1/DICOM_anon/i0095,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0000,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0001,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0002,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0003,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0004,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0005,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0006,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0007,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0008,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0009,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0010,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0011,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0012,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0013,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0014,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0015,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0016,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0017,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0018,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0019,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0020,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0021,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0022,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0023,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0024,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0025,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0026,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0027,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0028,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0029,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0030,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0031,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0032,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0033,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0034,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0035,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0036,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0037,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0038,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0039,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0040,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0041,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0042,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0043,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0044,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0045,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0046,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0047,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0048,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0049,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0050,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0051,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0052,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0053,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0054,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0055,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0056,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0057,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0058,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0059,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0060,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0061,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0062,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0063,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0064,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0065,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0066,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0067,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0068,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0069,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0070,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0071,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0072,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0073,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0074,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0075,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0076,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0077,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0078,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0079,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0080,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0081,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0082,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0083,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0084,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0085,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0086,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0087,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0088,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0089,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0090,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0091,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0092,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0093,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0094,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0095,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0096,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0097,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0098,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0099,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0100,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0101,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0102,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0103,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0104,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0105,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0106,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0107,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0108,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT10/DICOM_anon/i0109,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0000,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0001,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0002,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0003,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0004,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0005,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0006,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0007,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0008,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0009,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0010,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0011,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0012,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0013,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0014,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0015,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0016,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0017,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0018,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0019,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0020,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0021,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0022,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0023,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0024,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0025,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0026,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0027,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0028,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0029,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0030,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0031,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0032,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0033,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0034,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0035,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0036,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0037,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0038,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0039,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0040,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0041,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0042,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0043,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0044,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0045,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0046,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0047,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0048,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0049,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0050,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0051,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0052,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0053,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0054,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0055,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0056,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0057,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0058,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0059,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0060,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0061,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0062,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0063,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0064,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0065,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0066,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0067,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0068,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0069,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0070,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0071,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0072,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0073,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0074,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0075,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0076,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0077,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0078,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0079,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0080,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0081,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0082,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0083,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0084,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0085,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0086,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0087,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0088,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0089,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0090,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0091,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0092,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0093,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT14/DICOM_anon/i0094,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0000,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0001,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0002,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0003,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0004,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0005,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0006,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0007,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0008,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0009,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0010,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0011,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0012,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0013,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0014,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0015,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0016,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0017,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0018,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0019,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0020,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0021,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0022,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0023,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0024,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0025,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0026,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0027,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0028,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0029,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0030,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0031,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0032,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0033,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0034,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0035,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0036,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0037,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0038,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0039,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0040,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0041,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0042,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0043,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0044,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0045,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0046,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0047,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0048,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0049,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0050,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0051,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0052,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0053,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0054,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0055,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0056,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0057,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0058,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0059,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0060,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0061,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0062,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0063,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0064,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0065,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0066,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0067,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0068,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0069,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0070,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0071,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0072,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0073,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0074,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0075,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0076,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0077,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0078,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0079,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0080,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0081,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0082,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0083,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0084,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0085,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0086,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0087,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0088,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0089,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT16/DICOM_anon/i0090,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0000,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0001,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0002,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0003,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0004,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0005,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0006,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0007,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0008,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0009,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0010,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0011,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0012,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0013,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0014,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0015,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0016,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0017,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0018,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0019,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0020,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0021,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0022,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0023,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0024,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0025,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0026,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0027,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0028,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0029,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0030,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0031,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0032,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0033,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0034,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0035,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0036,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0037,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0038,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0039,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0040,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0041,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0042,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0043,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0044,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0045,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0046,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0047,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0048,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0049,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0050,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0051,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0052,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0053,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0054,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0055,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0056,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0057,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0058,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0059,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0060,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0061,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0062,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0063,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0064,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0065,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0066,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0067,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0068,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0069,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0070,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0071,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0072,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0073,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0074,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0075,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0076,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0077,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0078,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0079,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0080,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0081,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0082,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0083,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0084,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0085,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0086,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0087,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0088,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0089,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0090,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0091,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0092,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0093,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0094,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0095,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0096,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0097,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0098,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0099,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0100,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0101,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0102,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0103,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0104,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0105,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0106,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0107,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0108,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0109,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT18/DICOM_anon/i0110,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0000,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0001,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0002,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0003,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0004,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0005,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0006,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0007,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0008,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0009,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0010,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0011,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0012,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0013,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0014,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0015,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0016,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0017,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0018,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0019,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0020,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0021,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0022,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0023,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0024,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0025,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0026,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0027,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0028,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0029,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0030,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0031,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0032,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0033,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0034,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0035,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0036,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0037,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0038,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0039,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0040,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0041,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0042,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0043,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0044,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0045,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0046,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0047,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0048,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0049,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0050,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0051,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0052,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0053,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0054,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0055,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0056,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0057,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0058,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0059,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0060,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0061,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0062,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0063,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0064,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0065,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0066,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0067,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0068,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0069,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0070,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0071,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0072,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0073,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0074,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0075,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0076,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0077,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0078,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0079,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0080,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0081,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0082,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0083,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0084,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0085,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0086,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0087,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0088,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT19/DICOM_anon/i0089,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0000,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0001,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0002,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0003,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0004,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0005,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0006,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0007,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0008,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0009,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0010,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0011,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0012,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0013,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0014,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0015,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0016,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0017,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0018,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0019,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0020,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0021,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0022,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0023,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0024,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0025,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0026,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0027,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0028,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0029,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0030,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0031,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0032,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0033,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0034,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0035,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0036,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0037,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0038,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0039,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0040,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0041,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0042,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0043,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0044,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0045,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0046,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0047,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0048,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0049,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0050,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0051,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0052,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0053,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0054,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0055,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0056,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0057,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0058,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0059,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0060,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0061,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0062,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0063,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0064,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0065,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0066,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0067,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0068,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0069,0000b.dcm', 'drive/My Drive/CHAOS/Train_Sets/CT/CT2/DICOM_anon/i0070,0000b.dcm', ..., 'drive/My Drive/CHAOS/Train_Sets/CT/CT8/Ground/liver_GT_121.png', 'drive/My Drive/CHAOS/Train_Sets/CT/CT8/Ground/liver_GT_122.png']


Буферизация изображений
def buffer_imgs(filenames, is_dicom, folder='buffer'):
    files = []
    if not os.path.exists(folder):
        os.makedirs(folder)
    for filename in tqdm_notebook(filenames, position=0):
        img, header = load(filename)
        pil = Image.fromarray(img.squeeze())
        fname = folder + '/' + filename.replace('/', '-')
        if is_dicom:
            fname = fname+'.tiff'
            pil.save(fname, 'TIFF', compression='none')
        else:
            pil.save(fname, fname.split('.')[-1], compression='none')
        files.append(fname)
    return pd.DataFrame(files)
Разделение данных на тренировочные и тестовые
X = buffer_imgs(X_filenames, True)
y = buffer_imgs(y_filenames, False)
<ipython-input-6-c77ba89e7316>:5: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0
Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`
  for filename in tqdm_notebook(filenames, position=0):



X.shape, y.shape
((2608, 1), (2608, 1))
def show_img(n):
    """
    Show the n-th image with its segmentation mask.

    """
    plt.figure(figsize=(5,5))
    plt.imshow(Image.open(X[0][n]))
    plt.imshow(Image.open(y[0][n]), alpha=0.4)
    plt.title(n)

# let's look at 10 random images
for i in np.random.choice(np.arange(y.shape[0]), 10):
    show_img(i)

X_train, X_test, y_train, y_test = tts(X, y, test_size=0.3, shuffle=True, random_state=SEED)
Определение метрик и модели UNet
from keras.models import Model, load_model
from keras import backend as K

from keras.layers import Input, Conv2D, MaxPooling2D, UpSampling2D, concatenate, Dropout, BatchNormalization
from keras.optimizers import Adam, RMSprop
from keras.preprocessing.image import ImageDataGenerator
from keras.callbacks import LearningRateScheduler, ReduceLROnPlateau, EarlyStopping

K.set_image_data_format('channels_first')


def dice_coef(y_true, y_pred):
    smooth = 1e-20
    y_true_f = K.cast(y_true, 'float32')
    intersection = K.sum(y_true_f * y_pred)
    return (2 * intersection + smooth) / (K.sum(y_true_f) + K.sum(y_pred) + smooth)

def dice_coef_loss(y_true, y_pred):
    return 1 - dice_coef(y_true, y_pred)

def jaccard_coef(y_true, y_pred):
    smooth = 1e-20
    y_true_f = K.cast(y_true, 'float32')
    intersection = K.sum(y_true_f * y_pred)
    union = K.sum(y_true_f + y_pred) - intersection
    return (intersection + smooth) / (union + smooth)

def jaccard_coef_loss(y_true, y_pred):
    return 1 - jaccard_coef(y_true, y_pred)

def unet_1(img_channels, image_rows, image_cols, neurons=16):
    inputs = Input((img_channels, image_rows, image_cols))
    conv1 = Conv2D(neurons*1, (3, 3), activation='relu', padding='same')(inputs)
    conv1 = Conv2D(neurons*1, (3, 3), activation='relu', padding='same')(conv1)
    conv1 = BatchNormalization()(conv1)
    pool1 = MaxPooling2D(pool_size=(2, 2))(conv1)
    pool1 = Dropout(0.25)(pool1)

    conv2 = Conv2D(neurons*2, (3, 3), activation='relu', padding='same')(pool1)
    conv2 = Conv2D(neurons*2, (3, 3), activation='relu', padding='same')(conv2)
    conv2 = BatchNormalization()(conv2)
    pool2 = MaxPooling2D(pool_size=(2, 2))(conv2)
    pool2 = Dropout(0.5)(pool2)

    conv3 = Conv2D(neurons*4, (3, 3), activation='relu', padding='same')(pool2)
    conv3 = Conv2D(neurons*4, (3, 3), activation='relu', padding='same')(conv3)
    conv3 = BatchNormalization()(conv3)
    pool3 = MaxPooling2D(pool_size=(2, 2))(conv3)
    pool3 = Dropout(0.5)(pool3)

    conv4 = Conv2D(neurons*8, (3, 3), activation='relu', padding='same')(pool3)
    conv4 = Conv2D(neurons*8, (3, 3), activation='relu', padding='same')(conv4)
    conv4 = BatchNormalization()(conv4)
    pool4 = MaxPooling2D(pool_size=(2, 2))(conv4)
    pool4 = Dropout(0.5)(pool4)

    conv5 = Conv2D(neurons*16, (3, 3), activation='relu', padding='same')(pool4)
    conv5 = Conv2D(neurons*16, (3, 3), activation='relu', padding='same')(conv5)

    up6 = concatenate([UpSampling2D(size=(2, 2))(conv5), conv4], axis=1)
    up6 = Dropout(0.5)(up6)
    conv6 = Conv2D(neurons*8, (3, 3), activation='relu', padding='same')(up6)
    conv6 = Conv2D(neurons*8, (3, 3), activation='relu', padding='same')(conv6)

    up7 = concatenate([UpSampling2D(size=(2, 2))(conv6), conv3], axis=1)
    up7 = Dropout(0.5)(up7)
    conv7 = Conv2D(neurons*4, (3, 3), activation='relu', padding='same')(up7)
    conv7 = Conv2D(neurons*4, (3, 3), activation='relu', padding='same')(conv7)

    up8 = concatenate([UpSampling2D(size=(2, 2))(conv7), conv2], axis=1)
    up8 = Dropout(0.5)(up8)
    conv8 = Conv2D(neurons*2, (3, 3), activation='relu', padding='same')(up8)
    conv8 = Conv2D(neurons*2, (3, 3), activation='relu', padding='same')(conv8)

    up9 = concatenate([UpSampling2D(size=(2, 2))(conv8), conv1], axis=1)
    up9 = Dropout(0.5)(up9)
    conv9 = Conv2D(neurons*1, (3, 3), activation='relu', padding='same')(up9)
    conv9 = Conv2D(neurons*1, (3, 3), activation='relu', padding='same')(conv9)

    conv10 = Dropout(0.5)(conv9)
    conv10 = Conv2D(1, (1, 1), activation='sigmoid')(conv10)

    model = Model(inputs=[inputs], outputs=[conv10])

    model.compile(optimizer="adam", loss=dice_coef_loss, metrics=[dice_coef])
    return model
def plot_history(history, scoring='dice_coef'):
    dct = history.history
    fig, ax = plt.subplots(1, 3, figsize=(15, 5))
    ax[0].plot(dct['loss'], label='loss')
    ax[0].plot(dct['val_loss'], label='val_loss')
    ax[1].plot(dct[scoring], label=scoring)
    ax[1].plot(dct[f'val_{scoring}'], label=f'val_{scoring}')
    if 'lr' in dct:
        ax[2].plot(dct['lr'], label='lr')
    [a.legend() for a in ax]
Подготовка генераторов данных и обучение модели
X_train.shape, y_train.shape

w_size = np.array(Image.open(X[0][0])).shape[0]
model_1 = unet_1(1, w_size, w_size, 8)

X_tr, X_val, y_tr, y_val = tts(X_train, y_train, test_size=0.1, shuffle=True, random_state=SEED)
%%time
reduce_lr = ReduceLROnPlateau(monitor='val_loss', factor=0.5, patience=10, min_lr=0.00001)
early_stop = EarlyStopping(patience=30)

gen_train_params = {
    'rotation_range':10,
    'fill_mode':'reflect',
}

idg_train_data = ImageDataGenerator(
    samplewise_center=True,
    samplewise_std_normalization=True,
                                    **gen_train_params,
                             )
idg_train_mask = ImageDataGenerator(rescale=1./255,
                                    **gen_train_params)

train_gen_params = {
    'x_col': 0,
    'target_size': (512, 512),
    'color_mode': 'grayscale',
    'batch_size': 4,
    'class_mode': None,
    'shuffle': True,
    'seed': SEED,
}
val_gen_params = train_gen_params.copy()
val_gen_params['shuffle'] = False
val_gen_params['batch_size'] = 1

data_train_generator = idg_train_data.flow_from_dataframe(X_tr, **train_gen_params)
mask_train_generator = idg_train_mask.flow_from_dataframe(y_tr, **train_gen_params)
train_generator = zip(data_train_generator, (x.astype(np.uint8) for x in mask_train_generator))

idg_test_data = ImageDataGenerator(
    samplewise_center=True,
    samplewise_std_normalization=True
                                  )
idg_test_mask = ImageDataGenerator(rescale=1./255)
data_test_generator = idg_test_data.flow_from_dataframe(X_val,**val_gen_params)
mask_test_generator = idg_test_mask.flow_from_dataframe(y_val, **val_gen_params)
test_generator = zip(data_test_generator, (x.astype(np.uint8) for x in mask_test_generator))


history = model_1.fit(
    train_generator,
    validation_data=test_generator,
    steps_per_epoch=X_tr.shape[0]//train_gen_params['batch_size'],
    validation_steps=X_val.shape[0] // val_gen_params['batch_size'],
    verbose=1,
    epochs=150,
    callbacks=[early_stop, reduce_lr]
)
Found 1642 validated image filenames.
Found 1642 validated image filenames.
Found 183 validated image filenames.
Found 183 validated image filenames.
Epoch 1/150
410/410 [==============================] - 61s 136ms/step - loss: 0.5425 - dice_coef: 0.4575 - val_loss: 0.5589 - val_dice_coef: 0.4411 - lr: 0.0010
Epoch 2/150
410/410 [==============================] - 55s 134ms/step - loss: 0.3743 - dice_coef: 0.6250 - val_loss: 0.4064 - val_dice_coef: 0.5936 - lr: 0.0010
Epoch 3/150
410/410 [==============================] - 55s 133ms/step - loss: 0.3331 - dice_coef: 0.6666 - val_loss: 0.3765 - val_dice_coef: 0.6235 - lr: 0.0010
Epoch 4/150
410/410 [==============================] - 54s 131ms/step - loss: 0.2817 - dice_coef: 0.7185 - val_loss: 0.3927 - val_dice_coef: 0.6073 - lr: 0.0010
Epoch 5/150
410/410 [==============================] - 54s 132ms/step - loss: 0.2555 - dice_coef: 0.7443 - val_loss: 0.3441 - val_dice_coef: 0.6559 - lr: 0.0010
Epoch 6/150
410/410 [==============================] - 54s 131ms/step - loss: 0.2257 - dice_coef: 0.7743 - val_loss: 0.3237 - val_dice_coef: 0.6763 - lr: 0.0010
Epoch 7/150
410/410 [==============================] - 54s 132ms/step - loss: 0.2211 - dice_coef: 0.7785 - val_loss: 0.2960 - val_dice_coef: 0.7040 - lr: 0.0010
Epoch 8/150
410/410 [==============================] - 55s 135ms/step - loss: 0.2009 - dice_coef: 0.7991 - val_loss: 0.2877 - val_dice_coef: 0.7123 - lr: 0.0010
Epoch 9/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1955 - dice_coef: 0.8042 - val_loss: 0.2733 - val_dice_coef: 0.7267 - lr: 0.0010
Epoch 10/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1875 - dice_coef: 0.8126 - val_loss: 0.2663 - val_dice_coef: 0.7337 - lr: 0.0010
Epoch 11/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1774 - dice_coef: 0.8226 - val_loss: 0.2477 - val_dice_coef: 0.7523 - lr: 0.0010
Epoch 12/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1839 - dice_coef: 0.8161 - val_loss: 0.2623 - val_dice_coef: 0.7377 - lr: 0.0010
Epoch 13/150
410/410 [==============================] - 58s 141ms/step - loss: 0.1739 - dice_coef: 0.8261 - val_loss: 0.2471 - val_dice_coef: 0.7529 - lr: 0.0010
Epoch 14/150
410/410 [==============================] - 56s 136ms/step - loss: 0.1722 - dice_coef: 0.8278 - val_loss: 0.2672 - val_dice_coef: 0.7328 - lr: 0.0010
Epoch 15/150
410/410 [==============================] - 56s 136ms/step - loss: 0.1730 - dice_coef: 0.8271 - val_loss: 0.2493 - val_dice_coef: 0.7507 - lr: 0.0010
Epoch 16/150
410/410 [==============================] - 56s 136ms/step - loss: 0.1706 - dice_coef: 0.8291 - val_loss: 0.2415 - val_dice_coef: 0.7585 - lr: 0.0010
Epoch 17/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1704 - dice_coef: 0.8297 - val_loss: 0.2508 - val_dice_coef: 0.7492 - lr: 0.0010
Epoch 18/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1667 - dice_coef: 0.8334 - val_loss: 0.2395 - val_dice_coef: 0.7605 - lr: 0.0010
Epoch 19/150
410/410 [==============================] - 56s 136ms/step - loss: 0.1635 - dice_coef: 0.8366 - val_loss: 0.2017 - val_dice_coef: 0.7983 - lr: 0.0010
Epoch 20/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1679 - dice_coef: 0.8321 - val_loss: 0.2416 - val_dice_coef: 0.7584 - lr: 0.0010
Epoch 21/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1683 - dice_coef: 0.8317 - val_loss: 0.2470 - val_dice_coef: 0.7530 - lr: 0.0010
Epoch 22/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1605 - dice_coef: 0.8395 - val_loss: 0.2468 - val_dice_coef: 0.7532 - lr: 0.0010
Epoch 23/150
410/410 [==============================] - 56s 136ms/step - loss: 0.1562 - dice_coef: 0.8438 - val_loss: 0.2445 - val_dice_coef: 0.7555 - lr: 0.0010
Epoch 24/150
410/410 [==============================] - 56s 135ms/step - loss: 0.1614 - dice_coef: 0.8382 - val_loss: 0.2396 - val_dice_coef: 0.7604 - lr: 0.0010
Epoch 25/150
410/410 [==============================] - 55s 133ms/step - loss: 0.1537 - dice_coef: 0.8464 - val_loss: 0.2349 - val_dice_coef: 0.7651 - lr: 0.0010
Epoch 26/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1615 - dice_coef: 0.8385 - val_loss: 0.2344 - val_dice_coef: 0.7656 - lr: 0.0010
Epoch 27/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1609 - dice_coef: 0.8390 - val_loss: 0.2359 - val_dice_coef: 0.7641 - lr: 0.0010
Epoch 28/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1586 - dice_coef: 0.8408 - val_loss: 0.2137 - val_dice_coef: 0.7863 - lr: 0.0010
Epoch 29/150
410/410 [==============================] - 55s 133ms/step - loss: 0.1531 - dice_coef: 0.8464 - val_loss: 0.2313 - val_dice_coef: 0.7687 - lr: 0.0010
Epoch 30/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1503 - dice_coef: 0.8497 - val_loss: 0.2319 - val_dice_coef: 0.7681 - lr: 5.0000e-04
Epoch 31/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1500 - dice_coef: 0.8501 - val_loss: 0.2313 - val_dice_coef: 0.7687 - lr: 5.0000e-04
Epoch 32/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1567 - dice_coef: 0.8433 - val_loss: 0.2314 - val_dice_coef: 0.7686 - lr: 5.0000e-04
Epoch 33/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1549 - dice_coef: 0.8451 - val_loss: 0.2322 - val_dice_coef: 0.7678 - lr: 5.0000e-04
Epoch 34/150
410/410 [==============================] - 55s 133ms/step - loss: 0.1514 - dice_coef: 0.8487 - val_loss: 0.1915 - val_dice_coef: 0.8085 - lr: 5.0000e-04
Epoch 35/150
410/410 [==============================] - 54s 133ms/step - loss: 0.1522 - dice_coef: 0.8478 - val_loss: 0.2196 - val_dice_coef: 0.7804 - lr: 5.0000e-04
Epoch 36/150
410/410 [==============================] - 54s 133ms/step - loss: 0.1547 - dice_coef: 0.8454 - val_loss: 0.2249 - val_dice_coef: 0.7751 - lr: 5.0000e-04
Epoch 37/150
410/410 [==============================] - 54s 133ms/step - loss: 0.1502 - dice_coef: 0.8498 - val_loss: 0.2308 - val_dice_coef: 0.7692 - lr: 5.0000e-04
Epoch 38/150
410/410 [==============================] - 54s 133ms/step - loss: 0.1549 - dice_coef: 0.8451 - val_loss: 0.2243 - val_dice_coef: 0.7757 - lr: 5.0000e-04
Epoch 39/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1530 - dice_coef: 0.8471 - val_loss: 0.2016 - val_dice_coef: 0.7984 - lr: 5.0000e-04
Epoch 40/150
410/410 [==============================] - 56s 138ms/step - loss: 0.1476 - dice_coef: 0.8524 - val_loss: 0.1927 - val_dice_coef: 0.8073 - lr: 5.0000e-04
Epoch 41/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1516 - dice_coef: 0.8484 - val_loss: 0.1752 - val_dice_coef: 0.8248 - lr: 5.0000e-04
Epoch 42/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1480 - dice_coef: 0.8520 - val_loss: 0.2288 - val_dice_coef: 0.7712 - lr: 5.0000e-04
Epoch 43/150
410/410 [==============================] - 56s 137ms/step - loss: 0.1490 - dice_coef: 0.8504 - val_loss: 0.2327 - val_dice_coef: 0.7673 - lr: 5.0000e-04
Epoch 44/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1519 - dice_coef: 0.8482 - val_loss: 0.2113 - val_dice_coef: 0.7887 - lr: 5.0000e-04
Epoch 45/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1464 - dice_coef: 0.8536 - val_loss: 0.2222 - val_dice_coef: 0.7778 - lr: 5.0000e-04
Epoch 46/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1486 - dice_coef: 0.8510 - val_loss: 0.2149 - val_dice_coef: 0.7851 - lr: 5.0000e-04
Epoch 47/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1492 - dice_coef: 0.8508 - val_loss: 0.2251 - val_dice_coef: 0.7749 - lr: 5.0000e-04
Epoch 48/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1495 - dice_coef: 0.8505 - val_loss: 0.2275 - val_dice_coef: 0.7725 - lr: 5.0000e-04
Epoch 49/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1498 - dice_coef: 0.8500 - val_loss: 0.1992 - val_dice_coef: 0.8008 - lr: 5.0000e-04
Epoch 50/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1458 - dice_coef: 0.8542 - val_loss: 0.2282 - val_dice_coef: 0.7718 - lr: 5.0000e-04
Epoch 51/150
410/410 [==============================] - 54s 132ms/step - loss: 0.1532 - dice_coef: 0.8469 - val_loss: 0.1852 - val_dice_coef: 0.8148 - lr: 5.0000e-04
Epoch 52/150
410/410 [==============================] - 54s 133ms/step - loss: 0.1493 - dice_coef: 0.8507 - val_loss: 0.2125 - val_dice_coef: 0.7875 - lr: 2.5000e-04
Epoch 53/150
410/410 [==============================] - 54s 132ms/step - loss: 0.1489 - dice_coef: 0.8511 - val_loss: 0.2112 - val_dice_coef: 0.7888 - lr: 2.5000e-04
Epoch 54/150
410/410 [==============================] - 54s 132ms/step - loss: 0.1479 - dice_coef: 0.8522 - val_loss: 0.1528 - val_dice_coef: 0.8472 - lr: 2.5000e-04
Epoch 55/150
410/410 [==============================] - 54s 132ms/step - loss: 0.1426 - dice_coef: 0.8572 - val_loss: 0.2132 - val_dice_coef: 0.7868 - lr: 2.5000e-04
Epoch 56/150
410/410 [==============================] - 54s 132ms/step - loss: 0.1487 - dice_coef: 0.8514 - val_loss: 0.1406 - val_dice_coef: 0.8594 - lr: 2.5000e-04
Epoch 57/150
410/410 [==============================] - 55s 133ms/step - loss: 0.1488 - dice_coef: 0.8513 - val_loss: 0.2017 - val_dice_coef: 0.7983 - lr: 2.5000e-04
Epoch 58/150
410/410 [==============================] - 55s 133ms/step - loss: 0.1474 - dice_coef: 0.8522 - val_loss: 0.2006 - val_dice_coef: 0.7994 - lr: 2.5000e-04
Epoch 59/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1466 - dice_coef: 0.8534 - val_loss: 0.2165 - val_dice_coef: 0.7835 - lr: 2.5000e-04
Epoch 60/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1446 - dice_coef: 0.8554 - val_loss: 0.2099 - val_dice_coef: 0.7901 - lr: 2.5000e-04
Epoch 61/150
410/410 [==============================] - 54s 133ms/step - loss: 0.1496 - dice_coef: 0.8494 - val_loss: 0.2232 - val_dice_coef: 0.7768 - lr: 2.5000e-04
Epoch 62/150
410/410 [==============================] - 54s 133ms/step - loss: 0.1485 - dice_coef: 0.8511 - val_loss: 0.2262 - val_dice_coef: 0.7738 - lr: 2.5000e-04
Epoch 63/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1482 - dice_coef: 0.8519 - val_loss: 0.1934 - val_dice_coef: 0.8066 - lr: 2.5000e-04
Epoch 64/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1456 - dice_coef: 0.8543 - val_loss: 0.2208 - val_dice_coef: 0.7792 - lr: 2.5000e-04
Epoch 65/150
410/410 [==============================] - 55s 133ms/step - loss: 0.1446 - dice_coef: 0.8551 - val_loss: 0.1469 - val_dice_coef: 0.8531 - lr: 2.5000e-04
Epoch 66/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1473 - dice_coef: 0.8528 - val_loss: 0.2171 - val_dice_coef: 0.7829 - lr: 2.5000e-04
Epoch 67/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1497 - dice_coef: 0.8498 - val_loss: 0.1718 - val_dice_coef: 0.8282 - lr: 1.2500e-04
Epoch 68/150
410/410 [==============================] - 54s 133ms/step - loss: 0.1440 - dice_coef: 0.8561 - val_loss: 0.1714 - val_dice_coef: 0.8286 - lr: 1.2500e-04
Epoch 69/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1473 - dice_coef: 0.8524 - val_loss: 0.1713 - val_dice_coef: 0.8287 - lr: 1.2500e-04
Epoch 70/150
410/410 [==============================] - 55s 133ms/step - loss: 0.1512 - dice_coef: 0.8485 - val_loss: 0.1211 - val_dice_coef: 0.8789 - lr: 1.2500e-04
Epoch 71/150
410/410 [==============================] - 55s 133ms/step - loss: 0.1436 - dice_coef: 0.8562 - val_loss: 0.1607 - val_dice_coef: 0.8393 - lr: 1.2500e-04
Epoch 72/150
410/410 [==============================] - 54s 133ms/step - loss: 0.1453 - dice_coef: 0.8546 - val_loss: 0.1817 - val_dice_coef: 0.8183 - lr: 1.2500e-04
Epoch 73/150
410/410 [==============================] - 55s 133ms/step - loss: 0.1423 - dice_coef: 0.8576 - val_loss: 0.1405 - val_dice_coef: 0.8595 - lr: 1.2500e-04
Epoch 74/150
410/410 [==============================] - 54s 132ms/step - loss: 0.1484 - dice_coef: 0.8515 - val_loss: 0.1750 - val_dice_coef: 0.8250 - lr: 1.2500e-04
Epoch 75/150
410/410 [==============================] - 54s 133ms/step - loss: 0.1413 - dice_coef: 0.8588 - val_loss: 0.1319 - val_dice_coef: 0.8681 - lr: 1.2500e-04
Epoch 76/150
410/410 [==============================] - 55s 133ms/step - loss: 0.1436 - dice_coef: 0.8563 - val_loss: 0.1479 - val_dice_coef: 0.8521 - lr: 1.2500e-04
Epoch 77/150
410/410 [==============================] - 56s 136ms/step - loss: 0.1464 - dice_coef: 0.8536 - val_loss: 0.1597 - val_dice_coef: 0.8403 - lr: 1.2500e-04
Epoch 78/150
410/410 [==============================] - 56s 136ms/step - loss: 0.1438 - dice_coef: 0.8563 - val_loss: 0.1784 - val_dice_coef: 0.8216 - lr: 1.2500e-04
Epoch 79/150
410/410 [==============================] - 56s 136ms/step - loss: 0.1468 - dice_coef: 0.8533 - val_loss: 0.2013 - val_dice_coef: 0.7987 - lr: 1.2500e-04
Epoch 80/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1431 - dice_coef: 0.8570 - val_loss: 0.1694 - val_dice_coef: 0.8306 - lr: 1.2500e-04
Epoch 81/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1477 - dice_coef: 0.8522 - val_loss: 0.1824 - val_dice_coef: 0.8176 - lr: 6.2500e-05
Epoch 82/150
410/410 [==============================] - 56s 137ms/step - loss: 0.1462 - dice_coef: 0.8539 - val_loss: 0.1650 - val_dice_coef: 0.8350 - lr: 6.2500e-05
Epoch 83/150
410/410 [==============================] - 55s 135ms/step - loss: 0.1370 - dice_coef: 0.8631 - val_loss: 0.1687 - val_dice_coef: 0.8313 - lr: 6.2500e-05
Epoch 84/150
410/410 [==============================] - 56s 136ms/step - loss: 0.1477 - dice_coef: 0.8523 - val_loss: 0.1737 - val_dice_coef: 0.8263 - lr: 6.2500e-05
Epoch 85/150
410/410 [==============================] - 56s 137ms/step - loss: 0.1495 - dice_coef: 0.8501 - val_loss: 0.1688 - val_dice_coef: 0.8312 - lr: 6.2500e-05
Epoch 86/150
410/410 [==============================] - 56s 136ms/step - loss: 0.1435 - dice_coef: 0.8566 - val_loss: 0.1605 - val_dice_coef: 0.8395 - lr: 6.2500e-05
Epoch 87/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1489 - dice_coef: 0.8500 - val_loss: 0.1338 - val_dice_coef: 0.8662 - lr: 6.2500e-05
Epoch 88/150
410/410 [==============================] - 55s 134ms/step - loss: 0.1465 - dice_coef: 0.8535 - val_loss: 0.1589 - val_dice_coef: 0.8411 - lr: 6.2500e-05
Epoch 89/150
410/410 [==============================] - 57s 138ms/step - loss: 0.1394 - dice_coef: 0.8605 - val_loss: 0.1416 - val_dice_coef: 0.8584 - lr: 6.2500e-05
Epoch 90/150
410/410 [==============================] - 57s 139ms/step - loss: 0.1467 - dice_coef: 0.8534 - val_loss: 0.1368 - val_dice_coef: 0.8632 - lr: 6.2500e-05
Epoch 91/150
410/410 [==============================] - 58s 141ms/step - loss: 0.1422 - dice_coef: 0.8577 - val_loss: 0.1613 - val_dice_coef: 0.8387 - lr: 3.1250e-05
Epoch 92/150
410/410 [==============================] - 57s 139ms/step - loss: 0.1472 - dice_coef: 0.8524 - val_loss: 0.1675 - val_dice_coef: 0.8325 - lr: 3.1250e-05
Epoch 93/150
410/410 [==============================] - 58s 142ms/step - loss: 0.1471 - dice_coef: 0.8529 - val_loss: 0.1627 - val_dice_coef: 0.8373 - lr: 3.1250e-05
Epoch 94/150
410/410 [==============================] - 59s 144ms/step - loss: 0.1462 - dice_coef: 0.8538 - val_loss: 0.1667 - val_dice_coef: 0.8333 - lr: 3.1250e-05
Epoch 95/150
410/410 [==============================] - 59s 144ms/step - loss: 0.1410 - dice_coef: 0.8588 - val_loss: 0.1681 - val_dice_coef: 0.8319 - lr: 3.1250e-05
Epoch 96/150
410/410 [==============================] - 58s 142ms/step - loss: 0.1421 - dice_coef: 0.8574 - val_loss: 0.1639 - val_dice_coef: 0.8361 - lr: 3.1250e-05
Epoch 97/150
410/410 [==============================] - 59s 143ms/step - loss: 0.1469 - dice_coef: 0.8520 - val_loss: 0.1320 - val_dice_coef: 0.8680 - lr: 3.1250e-05
Epoch 98/150
410/410 [==============================] - 59s 143ms/step - loss: 0.1432 - dice_coef: 0.8566 - val_loss: 0.1710 - val_dice_coef: 0.8290 - lr: 3.1250e-05
Epoch 99/150
410/410 [==============================] - 59s 143ms/step - loss: 0.1480 - dice_coef: 0.8521 - val_loss: 0.1634 - val_dice_coef: 0.8366 - lr: 3.1250e-05
Epoch 100/150
410/410 [==============================] - 59s 143ms/step - loss: 0.1434 - dice_coef: 0.8566 - val_loss: 0.1411 - val_dice_coef: 0.8589 - lr: 3.1250e-05
CPU times: user 2h 33min 19s, sys: 1min 28s, total: 2h 34min 48s
Wall time: 1h 32min 20s

plot_history(history)

from google.colab import files

name = 'unet_r.h5'
model_1.save(name)

files.download(name)
/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py:3103: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(

<IPython.core.display.Javascript object>
<IPython.core.display.Javascript object>


Предсказания модели


def evaluate(x_names, y_names, set_name='evaluating', plot_pairs=0):
    val_gen_params['batch_size'] = 1
    print(set_name)
    dices = []
    jccrs = []
    mdices = []
    mjccrs = []
    data_g = idg_test_data.flow_from_dataframe(x_names, **val_gen_params)
    mask_g = idg_test_mask.flow_from_dataframe(y_names, **val_gen_params)
    for i, image_mask in enumerate(zip(tqdm_notebook(data_g), mask_g)):
        if i > x_names.shape[0] // val_gen_params['batch_size']:
            break
        image, mask = image_mask
        if mask.max() == 0:
            continue
        p = model_1.predict(image).astype('uint8')
        dice = dc(p, mask)
        dices.append(dice)
        try:
            jccr = jc(p, mask)
        except ZeroDivisionError as e:
            jccr = 1
        jccrs.append(jccr)

        if plot_pairs:
            plot_pairs -= 1
            fig, (ax1, ax2) = plt.subplots(1,2, figsize=(5,10))
            ax1.imshow(image.squeeze())
            ax1.imshow(mask.squeeze(), alpha=0.5, cmap='autumn')
            ax1.set_title('ground')
            ax2.imshow(image.squeeze())
            ax2.imshow(p.squeeze(), alpha=0.5, cmap='autumn')
            ax2.set_title('predicted, dc={0:.2f}'.format(dice))
            plt.show()

    print('dice:', np.mean(dices))
    print('jccr:', np.mean(jccrs))
    print('-------------')
    return jccr
%%time
evaluate(X_tr, y_tr, 'TR SET', 10)
evaluate(X_val, y_val, 'VAL SET', 10)
evaluate(X_test, y_test, 'TEST SET', 20)
TR SET
Found 1642 validated image filenames.
Found 1642 validated image filenames.

<ipython-input-22-906d31bc895a>:10: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0
Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`
  for i, image_mask in enumerate(zip(tqdm_notebook(data_g), mask_g)):

1/1 [==============================] - 0s 268ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 19ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 18ms/step

1/1 [==============================] - 0s 18ms/step

1/1 [==============================] - 0s 19ms/step

1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 21ms/step
...
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
dice: 0.9639455285292167
jccr: 0.9396268691570955
-------------
VAL SET
Found 183 validated image filenames.
Found 183 validated image filenames.

<ipython-input-22-906d31bc895a>:10: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0
Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`
  for i, image_mask in enumerate(zip(tqdm_notebook(data_g), mask_g)):

1/1 [==============================] - 0s 24ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 28ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
dice: 0.9546957377999294
jccr: 0.9280898793495193
-------------
TEST SET
Found 783 validated image filenames.
Found 783 validated image filenames.

<ipython-input-22-906d31bc895a>:10: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0
Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`
  for i, image_mask in enumerate(zip(tqdm_notebook(data_g), mask_g)):

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 19ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 19ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 24ms/step

1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 24ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 27ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 24ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
...
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 27ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
dice: 0.9632233450697377
jccr: 0.9363407317212695
-------------
CPU times: user 2min 56s, sys: 16.1 s, total: 3min 12s
Wall time: 2min 54s







0.9803056153104369
Предсказания модели(find сontours)
import numpy as np
import matplotlib.pyplot as plt
from tqdm.notebook import tqdm_notebook
import cv2

def evaluate(x_names, y_names, set_name='evaluating', plot_pairs=0):
    val_gen_params['batch_size'] = 1
    print(set_name)
    dices = []
    jccrs = []

    data_g = idg_test_data.flow_from_dataframe(x_names, **val_gen_params)
    mask_g = idg_test_mask.flow_from_dataframe(y_names, **val_gen_params)

    for i, (image, mask) in enumerate(zip(tqdm_notebook(data_g), mask_g)):
        if i >= len(x_names):
            break
        if mask.max() == 0:
            continue

        p = model_1.predict(image).astype('uint8')
        dice = dc(p, mask)
        dices.append(dice)

        try:
            jccr = jc(p, mask)
        except ZeroDivisionError:
            jccr = 1
        jccrs.append(jccr)

        if plot_pairs > 0:
            plot_pairs -= 1

            mask_8uc1 = (mask.squeeze() * 255).astype(np.uint8)
            pred_8uc1 = (p.squeeze() * 255).astype(np.uint8)

            contours_true, _ = cv2.findContours(mask_8uc1, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
            contours_pred, _ = cv2.findContours(pred_8uc1, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

            fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(10, 5))
            ax1.imshow(image.squeeze(), cmap='gray')
            ax1.imshow(mask.squeeze(), alpha=0.5, cmap='autumn')
            for contour in contours_true:
                ax1.plot(contour[:, 0, 0], contour[:, 0, 1], 'b', linewidth=2)
            ax1.set_title('Истинная маска')

            ax2.imshow(image.squeeze(), cmap='gray')
            ax2.imshow(p.squeeze(), alpha=0.5, cmap='autumn')
            for contour in contours_pred:
                ax2.plot(contour[:, 0, 0], contour[:, 0, 1], 'r', linewidth=2)
            ax2.set_title(f'Предсказанная, Dice={dice:.2f}')
            plt.show()

    mean_dice = np.mean(dices)
    mean_jccr = np.mean(jccrs)

    print('Средний Dice:', mean_dice)
    print('Средний Jaccard:', mean_jccr)
    print('-------------')

    return mean_dice, mean_jccr
evaluate(X_tr, y_tr, 'TR SET', 10)
evaluate(X_val, y_val, 'VAL SET', 10)
evaluate(X_test, y_test, 'TEST SET', 30)
TR SET
Found 1642 validated image filenames.
Found 1642 validated image filenames.

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 19ms/step

1/1 [==============================] - 0s 19ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 19ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 19ms/step

1/1 [==============================] - 0s 19ms/step

1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 18ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
...
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 26ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 24ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
Средний Dice: 0.9639327241193794
Средний Jaccard: 0.9396093616048415
-------------
VAL SET
Found 183 validated image filenames.
Found 183 validated image filenames.

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 24ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 24ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 27ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 28ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 24ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 24ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 24ms/step
1/1 [==============================] - 0s 24ms/step
1/1 [==============================] - 0s 31ms/step
1/1 [==============================] - 0s 29ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 24ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 26ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 24ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 28ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 25ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 29ms/step
1/1 [==============================] - 0s 25ms/step
Средний Dice: 0.9547166155638204
Средний Jaccard: 0.9282277877590828
-------------
TEST SET
Found 783 validated image filenames.
Found 783 validated image filenames.

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 20ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 27ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 24ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 24ms/step

1/1 [==============================] - 0s 24ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 23ms/step

1/1 [==============================] - 0s 22ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 21ms/step

1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 24ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 22ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
...
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 19ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 23ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 20ms/step
1/1 [==============================] - 0s 21ms/step
1/1 [==============================] - 0s 21ms/step
Средний Dice: 0.9631808228335452
Средний Jaccard: 0.9362710567868967
-------------







(0.9631808228335452, 0.9362710567868967)
